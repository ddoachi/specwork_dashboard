---
# ============================================================================
# SPEC METADATA - This entire frontmatter section contains the spec metadata
# ============================================================================

# === IDENTIFICATION ===
id: '1031' # Numeric ID for stable reference
title: 'Initialize Nx Workspace with Base Configuration'
type: 'task' # prd | epic | feature | task | subtask | bug | spike
category: 'infrastructure'

# === HIERARCHY ===
parent: '1003' # Parent spec ID
children: [] # Child spec IDs (if any)
epic: '1000' # Root epic ID for this work
domain: 'infrastructure' # Business domain

# === WORKFLOW ===
status: 'draft' # draft | reviewing | approved | in-progress | testing | done
priority: 'high' # high | medium | low
assignee: '' # Who's working on this
reviewer: '' # Who should review (optional)

# === TRACKING ===
created: '2025-08-28' # YYYY-MM-DD
updated: '2025-08-28' # YYYY-MM-DD
due_date: '' # YYYY-MM-DD (optional)
estimated_hours: 2 # Time estimate in hours
actual_hours: 0 # Time spent so far

# === DEPENDENCIES ===
dependencies: [] # Must be done before this (spec IDs)
blocks: ['1032', '1033', '1034', '1035', '1036'] # This blocks these specs
related: [] # Related but not blocking (spec IDs)

# === IMPLEMENTATION ===
pull_requests: [] # GitHub PR numbers
commits: [] # Key implementation commits
context_file: "1003.context.md" # Implementation journal
worktree: '' # Worktree path (optional)
files: ['nx.json', 'package.json', '.gitignore', 'README.md'] # Key files to modify

# === METADATA ===
tags: ['nx', 'monorepo', 'workspace', 'initialization', 'setup'] # Searchable tags
effort: 'small' # small | medium | large | epic
risk: 'low' # low | medium | high

# ============================================================================
---

# Task 1031: Initialize Nx Workspace with Base Configuration

## Overview

Initialize a new Nx workspace with TypeScript and NestJS presets, configure the base workspace settings, and establish the foundational directory structure for the JTS monorepo.

## Acceptance Criteria

- [ ] Nx 17.2.8 workspace created with proper presets
- [ ] Base `nx.json` configured with task runner options
- [ ] Root `package.json` with all core dependencies
- [ ] Directory structure created (`apps/`, `libs/`, `tools/`, `configs/`)
- [ ] Basic `.gitignore` and documentation files
- [ ] Workspace validates with `nx list` and `nx graph`

## Technical Details

### 1. Initialize Nx Workspace

```bash
npx create-nx-workspace@17.2.8 jts \
  --preset=apps \
  --packageManager=npm \
  --nxCloud=false \
  --workspaceType=integrated
```

### 2. Core Dependencies Installation

```json
{
  "dependencies": {
    "@nestjs/common": "^10.3.0",
    "@nestjs/core": "^10.3.0",
    "@nestjs/platform-express": "^10.3.0",
    "rxjs": "^7.8.0",
    "reflect-metadata": "^0.1.13"
  },
  "devDependencies": {
    "@nx/eslint": "17.2.8",
    "@nx/jest": "17.2.8",
    "@nx/js": "17.2.8",
    "@nx/nest": "17.2.8",
    "@nx/node": "17.2.8",
    "@nx/workspace": "17.2.8",
    "nx": "17.2.8",
    "typescript": "^5.3.0"
  }
}
```

### 3. Base nx.json Configuration

```json
{
  "$schema": "./node_modules/nx/schemas/nx-schema.json",
  "version": 3,
  "tasksRunnerOptions": {
    "default": {
      "runner": "nx/tasks-runners/default",
      "options": {
        "cacheableOperations": ["build", "lint", "test", "e2e"],
        "parallel": 4,
        "maxParallel": 6
      }
    }
  }
}
```

### 4. Directory Structure

```
jts/
├── apps/           # Microservices and applications
├── libs/           # Shared libraries
├── tools/          # Build tools and scripts
│   ├── generators/ # Custom Nx generators
│   ├── executors/  # Custom Nx executors
│   └── scripts/    # Utility scripts
├── configs/        # Configuration files
├── docs/           # Documentation
├── nx.json         # Nx configuration
├── package.json    # Root package.json
├── tsconfig.base.json # Base TypeScript config
└── .gitignore      # Git ignore rules
```

## Implementation Steps

1. **Create workspace** (30 min)
   - Run Nx workspace creation command
   - Select appropriate options for integrated monorepo
   - Verify installation success

2. **Configure base settings** (45 min)
   - Update nx.json with optimized settings
   - Configure task runner options
   - Set up caching configuration

3. **Install core dependencies** (30 min)
   - Add NestJS and related packages
   - Install Nx plugins for NestJS
   - Verify dependency tree

4. **Create directory structure** (15 min)
   - Create required directories
   - Add placeholder README files
   - Set up .gitkeep files

## Testing

```bash
# Verify Nx installation
nx --version

# List available plugins
nx list

# View dependency graph
nx graph

# Run format check
nx format:check

# Ensure clean workspace
nx reset
```

## Success Metrics

- Workspace initializes without errors
- All Nx commands run successfully
- Dependency graph shows no issues
- Base configuration supports parallel execution

## Notes

- This is the foundational task that all others depend on
- Focus on getting the base structure right
- Don't add application-specific configuration yet
- Ensure cross-platform compatibility from the start